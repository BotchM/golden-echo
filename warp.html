<!doctype html>
<html>
  <head></head>
  <body>
    <div class="scripts">
      <script src="third-party/two.js"></script>
      <script>

        var two = new Two({
          fullscreen: true,
          autostart: true
        }).appendTo(document.body);

        var triangle = two.makePolygon(_.map(_.range(3), function(i) {
          var pct = i / 3;
          var theta = Math.PI * 2 * pct;
          var x = 50 * Math.cos(theta);
          var y = 25 * Math.sin(theta);
          return new Two.Anchor(x, y);
        }));
        triangle.noStroke();
        triangle.fill = 'orange';

        var circle = two.makeCircle(0, 0, 50);
        circle.noStroke();
        circle.fill = 'dodgerblue';
        circle.curved = false;

        _.each(circle.vertices, function(v) {
          v.origin = new Two.Vector().copy(v);
        });

        var mouse = new Two.Vector();
        var vector = new Two.Vector();
        var offset = {
          min: new Two.Vector(),
          max: new Two.Vector(),
          value: new Two.Vector()
        };

        triangle.translation.set(two.width / 2, two.height / 2);

        window.addEventListener('mousemove', function(e) {

          mouse.set(e.clientX, e.clientY);

          triangle.rotation = Math.atan2(mouse.y - triangle.translation.y, mouse.x - triangle.translation.x);

          offset.max.set(-Infinity, -Infinity);
          offset.min.set(Infinity, Infinity);

          for (var i = 0, l = circle.vertices.length; i < l; i++) {

            var v = circle.vertices[i];
            var dist = vector.copy(triangle.translation)
              .subSelf(mouse).distanceTo(v);

            var pct = dist / two.width;
            vector.multiplyScalar(pct);

            v.x = v.origin.x - vector.x;
            v.y = v.origin.y - vector.y;

            offset.max.x = Math.max(v.x, offset.max.x);
            offset.min.x = Math.min(v.x, offset.min.x);
            offset.min.y = Math.min(v.y, offset.min.y);
            offset.max.y = Math.max(v.y, offset.max.y);

          }

          offset.value.set(
            (offset.max.x - offset.min.x) / 2 + offset.min.x,
            (offset.max.y - offset.min.y) / 2 + offset.min.y
          );

          circle.translation.set(mouse.x - offset.value.x, mouse.y - offset.value.y);

        });

      </script>
    </div>
  </body>
</html>