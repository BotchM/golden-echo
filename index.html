<!doctype html>
<html>
  <head>
  </head>
  <body>
    <div class="scripts">
      <script src="./third-party/tween.js"></script>
      <script src="./third-party/two.js"></script>
      <script src="./src/spline.js"></script>
      <script src="./src/path.js"></script>
      <script>

        var two = new Two({
          type: Two.Types.canvas,
          fullscreen: true,
          autostart: true
        }).appendTo(document.body);

        var spline = new Two.Spline(two.width, two.height / 2);
        spline.translation.set(two.width / 2, two.height);

        var circles = makeCircles(spline);

        var debug = two.makeGroup(spline);
        var stage = two.makeGroup(circles);

        window.addEventListener('mousemove', function(e) {

          var amt = 2 * (e.clientX / two.width) - 1;
          spline.turn(amt / 2);

        });

        two.bind('update', function() {

          for (var i = 0, l = circles.length; i < l; i++) {
            var circle = circles[i];
            var t = circle.t + circle.step;
            circle.update(t);
          }

        });

        function makeCircles(spline) {

          var amt = 100;

          return _.map(_.range(amt), function(i) {

            var r = Math.floor(Math.random() * 100);
            var s = Two.Path.makeCircle(r);

            s.noStroke();
            s.fill = 'rgb('
              + Math.floor(Math.random() * 255) + ','
              + Math.floor(Math.random() * 255) + ','
              + Math.floor(Math.random() * 255) + ')';

            s.spline = spline;
            s.step = r * 0.000325;

            s.t = Math.random();

            s.origin.set(
              5 * (Math.random() * two.width - two.width / 2),
              - Math.random() * two.height
            );

          return s;

          });

        }

      </script>
    </div>
  </body>
</html>